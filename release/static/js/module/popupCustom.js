define("popupCustom",function(e,n,a){function t(e){var n=o(e);return n.getCustomData(),n.ele&&n.ele.on("click",function(){n.openByEle({ele:n.ele})}),n}function o(e){var n={};for(var a in e)n[a]=e[a];return n.conf={ownEvent:e.ownEvent||"popupCustom",selected:"",type:e.type||"radio",group:[],showGroup:"",showList:[],groupData:{},other:{name:"",value:"",selected:!1},uploadFile:e.uploadFile||!1},n.getIdByName=l,n.getNameById=p,n.getCustomData=i,n.openByEle=u,n}function i(e){e=e||this,$.get(e.url||m,e.search,function(n){n&&n.data&&(r(n.data,e),e.ele&&d.bindAutoComplate(e.ele,e.autoData,e.ownEvent))},"json")}function r(e,n){var a=[],t={},o={},i={},r={},u=[];n.conf.selected=void 0,n.selected&&n.selected.id.forEach(function(e){r[e]=!0});for(var l in e){a.push({name:l,value:l});var p=[];e[l].forEach(function(e){var n=r[e.id]||!1;p.push({value:e.id,name:e.name,selected:n}),o[e.name]={id:e.id,name:e.name,parent:l,type:e.type},i[e.id]={id:e.id,name:e.name,parent:l,type:e.type},u.push(e.name)}),t[l]=[{item:p}]}a.sort(function(e,n){return n.value-e.value}),n.base={id_map:JSON.parse(JSON.stringify(i)),name_map:JSON.parse(JSON.stringify(o)),autoData:JSON.parse(JSON.stringify(u)),group:JSON.parse(JSON.stringify(a)),groupData:JSON.parse(JSON.stringify(t))},n.conf.group=a,n.conf.groupData=t,n.name_map=o,n.id_map=i,n.autoData=u}function u(e){var n=e.ele,a=e.autoComplateEvent||"autoComplateEvent";d.myEvent.init(a);var t=this;if(t.ele=n,t.handle=t.handle||{},t.handle.custom_ok=t.handle.custom_ok||function(){t.selected={id:c.selectData.id,name:t.getNameById(c.selectData.id)},t.ele.val(t.selected.name.join(";"))},t.handle.keydown=t.handle.keydown||function(){c.close()},e.conf)for(var o in e.conf)t.conf[o]=e.conf[o];d.myEvent.remove(n[0],t.conf.ownEvent,t.handle.custom_ok),d.myEvent.on(n[0],t.conf.ownEvent,t.handle.custom_ok),n.unbind("keydown",t.handle.keydown),n.bind("keydown",t.handle.keydown);var i=[];i=t.getIdByName(n.val());var r=n.val().split(";");i&&t.name_map[r[0]]&&(t.conf.showGroup=t.name_map[r[0]].parent),d.bindAutoComplate(e.ele,t.autoData,a),c.open(t.conf,i,n)}function l(e){var n=this.ele,a=e||n.val();a=a.length?a.split(";"):[];var t=this.name_map,o=[];return t&&a.forEach(function(e){t[e]&&o.push(t[e].id)}),o}function p(e){var n=this.id_map,a=[];return Array.isArray(e)?e.forEach(function(e){n[e]&&a.push(n[e].name)}):n[e]&&a.push(n[e].name),a}var s={},c=e("basePopupSelect"),d=e("myTool"),m="/customer_base/get_customer_info";s.init=t,a.exports=s});